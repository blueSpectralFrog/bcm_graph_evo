import jax
import equinox as eqx
  
start_key = jax.random.PRNGKey(1)

class Encoder(eqx.Module):
    """Two layer encoder for now"""

    layer_1: eqx.nn.Linear
    layer_2 = eqx.nn.Linear

    def __init__(self, in_features, hidden_features, out_features, *, key):
        key, subkey = jax.random.split(start_key)

        self.layer_1 = eqx.nn.Linear(in_features, hidden_features, key=key)
        self.layer_2 = eqx.nn.Linear(hidden_features, out_features, key=subkey)

    def __call__(self, x):
        x = self.layer_1(x)

        x = jax.nn.relu(x)

        x = self.layer_2(x)

        return x